!function(){function t(t=0,e=1){return v=16807*v%2147483647,(v-1)/2147483646*(e-t)+t}function e(t){return(e,n)=>{e.i.t[n]|=1,e.i.o[n]={s:n,l:t,u:[0,0],h:[]}}}function n(t){return(e,n)=>{e.i.t[n]|=2,e.i.m[n]={p:[Math.cos(t),Math.sin(t)]}}}function i(t){return(e,n)=>{e.i.t[n]|=4,e.i.v[n]={g:0,l:t,$:e.M}}}function o(t){return(e,n)=>{e.i.t[n]|=16,e.i.S[n]={p:[0,0],k:t}}}function s(t){let e=performance.now(),n=i=>{t.F((i-e)/1e3),t.R(),e=i,g=requestAnimationFrame(n)};l(),n(e)}function l(){cancelAnimationFrame(g)}function r(t,{I:e,A:n,C:i,D:o=[],T:s=[]}){let l=function(t,e=0){for(let n=0;n<y;n++)if(!t.t[n])return t.t[n]=e,n;throw Error("No more entities available.")}(t.i);!function(t=[0,0],e=0,n=[1,1]){return(i,o)=>{i.i.t[o]|=32,i.i.U[o]={s:o,i:[1,0,0,1,0,0],q:[1,0,0,1,0,0],I:t,A:e,C:n,T:[],j:1}}}(e,n,i)(t,l);for(let e of o)e(t,l);let a=t.i.U[l];for(let e of s){let n=r(t,e),i=t.i.U[n];i.K=a,a.T.push(i)}return l}function a(s){var l;s.i=new $,s.N=[],l=Date.now(),v=198706*l;for(let l=0;l<s.P;l++)r(s,{I:[t(0,s.W.width),t(0,s.W.height)],D:[i(3),e(3),o(50),n(t(0,2*Math.PI)),(t,e)=>{t.i.t[e]|=8,t.i.B[e]={G:"vulnerable",H:0}}]});let a=r(s,{I:[t(0,s.W.width),t(0,s.W.height)],D:[i(3),e(3),o(50),n(t(0,2*Math.PI)),(t,e)=>{t.i.t[e]|=8,t.i.B[e]={G:"vulnerable",H:0}}]});s.i.B[a].G="infected",s.i.v[a].$=s.J;for(let t=0;t<s.P*s.L;t++)2&s.i.t[t]&&(s.i.t[t]&=-17)}function c(t,e){let n=e[0],i=e[1],o=n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function u(t,e,n){for(let s=n;s<e.length;s++){let n=e[s];n!==t&&function(t,e){let n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}((i=t).u,(o=n).u)<(i.l+o.l)**2&&(t.h.push(n),n.h.push(t))}var i,o}function f(e,n){let i=e.i.m[n],o=e.i.U[n],s=0;o.I[0]<0&&(o.I[0]=0,i.p[0]=-i.p[0],s=1),o.I[0]>e.W.width&&(o.I[0]=e.W.width,i.p[0]=-i.p[0],s=1),o.I[1]<0&&(o.I[1]=0,i.p[1]=-i.p[1],s=1),o.I[1]>e.W.height&&(o.I[1]=e.W.height,i.p[1]=-i.p[1],s=1),s||(i.p[0]+=t(-.1,.1),i.p[1]+=t(-.1,.1),c(i.p,i.p));let l=e.i.S[n];l.p[0]=i.p[0],l.p[1]=i.p[1],c(l.p,l.p)}function h(t,e){t.O.fillStyle=e.$,t.O.beginPath(),t.O.arc(0,0,e.l,0,2*Math.PI),t.O.closePath(),t.O.fill()}function d(t,e,n){let i=t.i.B[e];if("infected"===i.G){if(i.H+=n,i.H>t.V)return i.G="recovered",t.i.v[e].$=t.X,void(t.i.t[e]&=-2);let o=t.i.o[e];for(let e=0;e<o.h.length;e++){let n=o.h[e];"vulnerable"===t.i.B[n.s].G&&(t.i.B[n.s].G="infected",t.i.v[n.s].$=t.J)}}}function m(t,e,n){let i=t.i.U[e],o=t.i.S[e];i.I[0]+=o.p[0]*o.k*n,i.I[1]+=o.p[1]*o.k*n,i.j=1}function p(t,...e){return t.reduce((t,n)=>t+function(t){let e=t.shift();return"boolean"==typeof e||null==e?"":Array.isArray(e)?e.join(""):e}(e)+n)}let v=1;const y=1e4;let g=0;class ${constructor(){this.t=[],this.o=[],this.m=[],this.v=[],this.B=[],this.S=[],this.U=[]}}let w,b=document.getElementById("update"),x=document.getElementById("delta"),M=document.getElementById("fps"),S=0,k=new class{constructor(){this.i=new $,this.Y={},this.Z={},this._=document.querySelector("nav"),this.W=document.querySelector("canvas#scene"),this.O=this.W.getContext("2d"),this.tt=document.querySelector("canvas#histo"),this.et=this.tt.getContext("2d"),this.nt="#222",this.M="#666",this.J="#f00",this.X="#0f0",this.P=300,this.L=0,this.V=10,this.N=[],document.addEventListener("visibilitychange",()=>document.hidden?l():s(this)),window.addEventListener("keydown",t=>{t.repeat||(this.Y[t.code]=1,this.Z[t.code]=1)}),window.addEventListener("keyup",t=>{this.Y[t.code]=0,this.Z[t.code]=-1}),this._.addEventListener("mousedown",t=>{this.Y[`Mouse${t.button}`]=1,this.Z[`Mouse${t.button}`]=1}),this._.addEventListener("mouseup",t=>{this.Y[`Mouse${t.button}`]=0,this.Z[`Mouse${t.button}`]=-1}),this._.addEventListener("mousemove",t=>{this.Y.it=t.offsetX,this.Y.ot=t.offsetY,this.Z.it=t.movementX,this.Z.ot=t.movementY}),this._.addEventListener("wheel",t=>{this.Z.st=t.deltaY}),this.W.width=this.W.clientWidth,this.W.height=this.W.clientHeight,this.tt.width=this.tt.clientWidth,this.tt.height=this.tt.clientHeight}R(){for(let t in this.Z)this.Z[t]=0}F(t){let e=performance.now();!function(t,e){for(let e=0;e<t.i.t.length;e++)50==(50&t.i.t[e])&&f(t,e)}(this),function(t,e){for(let n=0;n<t.i.t.length;n++)48==(48&t.i.t[n])&&m(t,n,e)}(this,t),function(t,e){for(let e=0;e<t.i.t.length;e++)32==(32&t.i.t[e])&&(i=void 0,o=void 0,(n=t.i.U[e]).j&&(n.j=0,function t(e){for(let n of e.T)n.j=1,t(n)}(n),o=n.I,(i=n.i)[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=o[0],i[5]=o[1],function(t,e,n){let i=e[0],o=e[1],s=e[2],l=e[3],r=e[4],a=e[5],c=Math.sin(n),u=Math.cos(n);t[0]=i*u+s*c,t[1]=o*u+l*c,t[2]=i*-c+s*u,t[3]=o*-c+l*u,t[4]=r,t[5]=a}(n.i,n.i,n.A),function(t,e,n){let i=e[1],o=e[2],s=e[3],l=e[4],r=e[5],a=n[0],c=n[1];t[0]=e[0]*a,t[1]=i*a,t[2]=o*c,t[3]=s*c,t[4]=l,t[5]=r}(n.i,n.i,n.C),n.K&&function(t,e,n){let i=e[0],o=e[1],s=e[2],l=e[3],r=e[4],a=e[5],c=n[0],u=n[1],f=n[2],h=n[3],d=n[4],m=n[5];t[0]=i*c+s*u,t[1]=o*c+l*u,t[2]=i*f+s*h,t[3]=o*f+l*h,t[4]=i*d+s*m+r,t[5]=o*d+l*m+a}(n.i,n.K.i,n.i),function(t,e){let n=e[0],i=e[1],o=e[2],s=e[3],l=e[4],r=e[5],a=n*s-i*o;a&&(a=1/a,t[0]=s*a,t[1]=-i*a,t[2]=-o*a,t[3]=n*a,t[4]=(o*r-s*l)*a,t[5]=(i*l-n*r)*a)}(n.q,n.i)));var n,i,o}(this),function(t,e){let n=[];for(let e=0;e<t.i.t.length;e++)if(33==(33&t.i.t[e])){let s=t.i.U[e],l=t.i.o[e];l.h=[],(i=l.u)[0]=(o=s.i)[4],i[1]=o[5],n.push(l)}var i,o;for(let t=0;t<n.length;t++)u(n[t],n,t+1)}(this),function(t,e){for(let n=0;n<t.i.t.length;n++)9==(9&t.i.t[n])&&d(t,n,e)}(this,t),function(t,e){if(S+=e,S>.06){S=0;let e=[0,0,0];for(let n=0;n<t.i.t.length;n++)if(8==(8&t.i.t[n]))switch(t.i.B[n].G){case"vulnerable":e[0]++;break;case"infected":e[1]++;break;case"recovered":e[2]++}t.N.push(e)}}(this,t),function(t,e){t.O.resetTransform(),t.O.fillStyle=t.nt,t.O.fillRect(0,0,t.W.width,t.W.height);for(let e=0;e<t.i.t.length;e++)if(36==(36&t.i.t[e])){let n=t.i.U[e];t.O.setTransform(n.i[0],n.i[1],n.i[2],n.i[3],n.i[4],n.i[5]);let i=t.i.v[e];switch(i.g){case 0:h(t,i)}}}(this),function(t,e){t.et.fillStyle="#333",t.et.fillRect(0,0,t.tt.width,t.tt.height);for(let e=0;e<t.N.length;e++){let n=t.N[e],i=n[0]/t.P*t.tt.height,o=n[1]/t.P*t.tt.height,s=n[2]/t.P*t.tt.height;t.et.fillStyle=t.X,t.et.fillRect(1*e,0,1,s),t.et.fillStyle=t.M,t.et.fillRect(1*e,s,1,i),t.et.fillStyle=t.J,t.et.fillRect(1*e,s+i,1,o)}}(this),function(t,e){let n=function(t){return p`<divstyle="display: flex;justify-content: space-between;padding: 5px;font: 12px monospace;"><div style="flex: 1; display: flex; flex-wrap: wrap;">${function(t){return p`<label style="display: flex; align-items: center; margin-right: 30px;">Population: ${t.P}<inputtype="range"min="1"max="1000"value="${t.P}"onchange="$(${0}, parseInt(this.value))"style="margin-left: 10px;"/></label>`}(t)} ${function(t){return p`<label style="display: flex; align-items: center; margin-right: 30px;">Distancing: ${Math.round(100*t.L)}%<inputtype="range"min="0"max="1"step="0.01"value="${t.L}"onchange="$(${1}, parseFloat(this.value))"style="margin-left: 10px;"/></label>`}(t)} ${function(t){return p`<label style="display: flex; align-items: center;">Recovery Time: ${t.V}s<inputtype="range"min="1"max="20"value="${t.V}"onchange="$(${2}, parseInt(this.value))"style="margin-left: 10px;"/></label>`}(t)}</div><buttononclick="$(${0}, ${t.P})"style="margin-left: 30px;">Restart</button></div>`}(t);n!==w&&(t._.innerHTML=w=n)}(this),function(t,e,n){b&&(b.textContent=n.toFixed(1)),x&&(x.textContent=(1e3*e).toFixed(1)),M&&(M.textContent=(1/e).toFixed())}(0,t,performance.now()-e)}};a(k),s(k),window.game=k,window.$=function(t,e,n){switch(e){case 0:t.P=n,requestAnimationFrame(()=>a(t));break;case 1:{t.L=n;let e=t.P*t.L;requestAnimationFrame(()=>{for(let n=0;n<t.i.t.length;n++)2&t.i.t[n]&&(n<e?t.i.t[n]&=-17:t.i.t[n]|=16)});break}case 2:t.V=n}}.bind(null,k)}();
